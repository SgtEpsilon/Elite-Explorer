<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Elite Explorer — Live</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Share+Tech+Mono&family=Orbitron:wght@400;500;700&family=Exo+2:wght@200;300;400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="topbar">
  <span class="tb-logo">&#9672; Explorer</span>
  <div class="tb-sep"></div>
  <span class="tb-cmdr" id="tb-cmdr">&#8212;</span>
  <div class="tb-sep"></div>
  <span class="tb-sys" id="tb-sys">&#8212;</span><span id="tb-discovery-star" title="First Discovery!" style="display:none;color:var(--gold);margin-left:4px;font-size:0.85em;">&#9733;</span>
  <div class="tab-nav">
    <a class="tab-btn active" href="index.html">Live</a>
    <a class="tab-btn" href="profile.html">Profile</a>
    <a class="tab-btn" href="history.html">History</a>
	<a class="tab-btn" href="spansh.html">Spansh</a>
  </div>
  <span class="tb-credits" id="tb-credits"></span>
  <span id="eddn-dot" title="EDDN: disabled" style="width:6px;height:6px;border-radius:50%;background:var(--border2);display:inline-block;margin-right:4px;transition:background 0.4s;"></span>
  <span id="edsm-dot" title="EDSM: disabled" style="width:6px;height:6px;border-radius:50%;background:var(--border2);display:inline-block;margin-right:8px;transition:background 0.4s;"></span>
  <button id="options-btn" title="Options">&#9881;</button>
</div>

<div id="app-wrapper" style="display:flex;flex-direction:column;height:calc(100vh - 44px);">

  <div id="view-live" class="active">

    <!-- LEFT COLUMN: Commander (scrollable) + Scan Summary (locked bottom) -->
    <div class="live-col" id="live-col-left">

      <div class="panel" id="panel-commander">
        <div class="panel-header">
          <span class="label">Commander</span>
          <div class="accent-line"></div>
        </div>
        <div class="panel-body">
          <div class="stat-group">
            <div class="stat-group-title">Navigation</div>
            <div class="stat-row"><span class="stat-key">System</span><span class="stat-val highlight" id="sys-name">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Pos</span><span class="stat-val" id="sys-pos" style="font-size:0.75em">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Security</span><span class="stat-val" id="sys-security" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Allegiance</span><span class="stat-val" id="sys-allegiance" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Economy</span><span class="stat-val" id="sys-economy" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Population</span><span class="stat-val" id="sys-population" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row">
              <span class="stat-key">EDSM</span>
              <a id="edsm-link" href="#" title="View on Elite Dangerous Star Map"
                 style="font-size:0.75em;color:var(--cyan);text-decoration:none;font-family:var(--mono);cursor:pointer;opacity:0.5;pointer-events:none;"
                 onclick="return false;">&#8599; View system</a>
            </div>
          </div>
          <div class="stat-group">
            <div class="stat-group-title">Ship Status</div>
            <div class="stat-row"><span class="stat-key">Name</span><span class="stat-val" id="ship-name" style="font-size:0.75em">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Type</span><span class="stat-val" id="ship-type" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Ident</span><span class="stat-val" id="ship-ident" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Jump Range</span><span class="stat-val highlight" id="ship-range">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Cargo Cap</span><span class="stat-val" id="ship-cargo">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Fuel</span><span class="stat-val" id="ship-fuel">&#8212;</span></div>
            <div class="fuel-bar-wrap"><div class="fuel-bar-fill" id="fuel-bar" style="width:0%"></div></div>
            <div class="stat-row" style="margin-top:4px;"><span class="stat-key">Hull</span><span class="stat-val green" id="ship-hull">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Rebuy</span><span class="stat-val red" id="ship-rebuy">&#8212;</span></div>
          </div>
          <div class="stat-group">
            <div class="stat-group-title">Station</div>
            <div class="stat-row"><span class="stat-key">Name</span><span class="stat-val" id="station-name" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Type</span><span class="stat-val" id="station-type" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Faction</span><span class="stat-val" id="station-faction" style="font-size:0.75em;color:var(--text-dim)">&#8212;</span></div>
            <div class="stat-row"><span class="stat-key">Credits</span><span class="stat-val gold" id="credits">&#8212;</span></div>
          </div>
        </div>
      </div>

      <div class="panel" id="panel-summary">
        <div class="panel-header">
          <span class="label">Scan Summary</span>
          <div class="accent-line"></div>
        </div>
        <div class="panel-body">
          <div class="summary-grid">
            <div><div class="summary-num" id="sum-stars">0</div><div class="summary-lbl">Stars</div></div>
            <div><div class="summary-num" id="sum-planets">0</div><div class="summary-lbl">Planets</div></div>
            <div><div class="summary-num" id="sum-moons">0</div><div class="summary-lbl">Moons</div></div>
            <div><div class="summary-num" id="sum-total">0</div><div class="summary-lbl">Total</div></div>
          </div>
        </div>
      </div>

    </div><!-- /live-col-left -->

    <!-- MIDDLE COLUMN: System Bodies (scrollable) + Journal Scan (locked bottom) + Log spacer -->
    <div class="live-col" id="live-col-mid">

      <div class="panel" id="panel-system">
        <div class="panel-header">
          <span class="label">System Bodies</span>
          <div class="accent-line"></div>
          <span style="font-family:var(--mono);font-size:0.75em;color:var(--text-mute)" id="body-count">0 bodies</span>
        </div>
        <div class="panel-body" style="padding:0;">
          <table class="bodies-table">
            <thead>
              <tr>
                <th style="width:28px"></th>
                <th>Name</th>
                <th>Class</th>
                <th>Distance</th>
                <th>Information</th>
                <th style="text-align:right">Value</th>
                <th style="text-align:right">Max</th>
              </tr>
            </thead>
            <tbody id="bodies-tbody">
              <tr><td colspan="7"><div class="empty-state"><div class="icon">&#9678;</div><div class="msg">Awaiting scan data</div></div></td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="panel-progress">
        <div class="panel-header" style="padding:6px 10px;">
          <span class="label">Journal Scan</span><div class="accent-line"></div>
          <span style="font-family:var(--mono);font-size:0.75em;color:var(--text-mute)" id="progress-pct">&#8212;</span>
          <span style="font-family:var(--mono);font-size:0.7em;color:var(--text-mute);margin-left:6px;" id="progress-info">Ready</span>
        </div>
        <div class="progress-track"><div class="progress-fill" id="progress-bar"></div></div>
        <div id="progress-detail" style="display:none;"></div>
      </div>

      <div class="col-log-spacer"></div>

    </div><!-- /live-col-mid -->

    <!-- RIGHT COLUMN: Scan Values (scrollable) + Application Log (locked bottom) -->
    <div class="live-col" id="live-col-right">

      <div class="panel" id="panel-scan">
        <div class="panel-header"><span class="label">Scan Values</span><div class="accent-line"></div></div>
        <div class="scan-total-bar"><span class="scan-total-label">EST. TOTAL</span><span class="scan-total-val" id="scan-total">0 cr</span></div>
        <div class="panel-body" style="padding:0;">
          <table class="scan-table">
            <thead>
              <tr>
                <th>Body</th>
                <th>Type</th>
                <th style="text-align:center">Mapped</th>
                <th style="text-align:right">Value</th>
              </tr>
            </thead>
            <tbody id="scan-tbody">
              <tr><td colspan="4"><div class="empty-state" style="height:60px;"><div class="msg">No scans yet</div></div></td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="panel" id="panel-log">
        <div class="panel-header">
          <span class="label">Application Log</span>
          <div class="accent-line"></div>
          <span id="log-count" style="font-family:var(--mono);font-size:0.75em;color:var(--text-mute)">0 entries</span>
        </div>
        <div id="log-entries"></div>
      </div>

    </div><!-- /live-col-right -->

  </div><!-- /view-live -->

</div><!-- /app-wrapper -->

<!-- OPTIONS PANEL -->
<div id="options-overlay"></div>
<div id="options-panel">
  <div id="options-header">
    <span style="font-family:var(--display);font-size:0.75em;letter-spacing:0.25em;color:var(--gold)">OPTIONS</span>
    <button id="options-close">&#10005;</button>
  </div>
  <div id="options-body">
    <div class="opt-section">
      <div class="opt-section-title">Journal Scan</div>
      <button class="opt-action-btn" id="opt-scan-btn">
        <span class="opt-btn-icon">&#11041;</span>
        <div><div class="opt-btn-label">Scan All Journals</div><div class="opt-btn-sub">Re-process all Elite journal files</div></div>
      </button>
    </div>
    <div class="opt-section">
      <div class="opt-section-title">EDDN — Data Network</div>
      <label class="opt-toggle" style="margin-bottom:8px;">
        <input type="checkbox" id="opt-eddn-enabled">
        <span class="tog-track"><span class="tog-thumb"></span></span>
        <span class="tog-lbl">Submit events to EDDN</span>
      </label>
      <div class="opt-hint">Shares jump, scan &amp; dock events with the community network. Your commander name is used as the uploader ID.</div>
      <div style="margin-top:8px;">
        <label style="font-size:0.72em;color:var(--text-dim);display:block;margin-bottom:3px;">Commander Name (uploader ID)</label>
        <input class="opt-input" id="opt-cmdr-name" type="text" placeholder="Your in-game commander name" spellcheck="false"/>
      </div>
    </div>
    <div class="opt-section">
      <div class="opt-section-title">EDSM — Star Map</div>
      <label class="opt-toggle" style="margin-bottom:8px;">
        <input type="checkbox" id="opt-edsm-enabled">
        <span class="tog-track"><span class="tog-thumb"></span></span>
        <span class="tog-lbl">Fetch system data from EDSM</span>
      </label>
      <div class="opt-hint">Displays security, allegiance, population and enables the EDSM link for each system you visit. No account required for lookups.</div>
      <div style="margin-top:8px;">
        <label style="font-size:0.72em;color:var(--text-dim);display:block;margin-bottom:3px;">EDSM Commander Name <span style="opacity:0.5">(optional — for flight log sync)</span></label>
        <input class="opt-input" id="opt-edsm-cmdr" type="text" placeholder="Your EDSM commander name" spellcheck="false"/>
      </div>
      <div style="margin-top:6px;">
        <label style="font-size:0.72em;color:var(--text-dim);display:block;margin-bottom:3px;">EDSM API Key <span style="opacity:0.5">(optional — from edsm.net/en/settings/api)</span></label>
        <input class="opt-input" id="opt-edsm-key" type="password" placeholder="••••••••••••••••" spellcheck="false"/>
      </div>
      <button class="opt-action-btn" id="opt-save-api-btn" style="margin-top:10px;">
        <span class="opt-btn-icon">&#10003;</span>
        <div><div class="opt-btn-label">Save API Settings</div><div class="opt-btn-sub" id="opt-api-hint">Changes take effect immediately</div></div>
      </button>
    </div>
    <div class="opt-section">
      <div class="opt-section-title">Journal Folder</div>
      <div class="opt-path-row">
        <input class="opt-input" id="opt-journal-path" type="text" placeholder="Auto-detected" spellcheck="false"/>
        <button class="opt-icon-btn" id="opt-browse-btn" title="Browse">&#9645;</button>
        <button class="opt-icon-btn" id="opt-open-btn" title="Open in Explorer">&#8599;</button>
      </div>
      <div class="opt-hint" id="opt-path-hint">Leave blank to use the default path for your OS</div>
    </div>
    <div class="opt-section">
      <div class="opt-section-title">Theme</div>
      <div class="opt-theme-grid">
        <div class="opt-theme-swatch active" data-theme="default"><div class="swatch-bar" style="background:#c8972a"></div><div class="swatch-bar" style="background:#2ecfcf"></div><span>Default</span></div>
        <div class="opt-theme-swatch" data-theme="red"><div class="swatch-bar" style="background:#e05252"></div><div class="swatch-bar" style="background:#cf7a3e"></div><span>Red Alert</span></div>
        <div class="opt-theme-swatch" data-theme="green"><div class="swatch-bar" style="background:#4caf7d"></div><div class="swatch-bar" style="background:#a0cf3e"></div><span>Viridian</span></div>
        <div class="opt-theme-swatch" data-theme="purple"><div class="swatch-bar" style="background:#a855f7"></div><div class="swatch-bar" style="background:#cf3ecf"></div><span>Nebula</span></div>
      </div>
    </div>
    <div class="opt-section">
      <div class="sl-group">
        <div class="sl-group-title">Scale &amp; Size</div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">UI Scale</span><span class="sl-val" id="sv-scale">100%</span></div><input type="range" class="sl-input" id="sl-scale" min="70" max="130" step="1" value="100"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Font Size</span><span class="sl-val" id="sv-font">24px</span></div><input type="range" class="sl-input" id="sl-font" min="1" max="32" step="0.5" value="24"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Row Density</span><span class="sl-val" id="sv-density">Normal</span></div><input type="range" class="sl-input" id="sl-density" min="1" max="5" step="1" value="3"></div>
      </div>
      <div class="sl-group">
        <div class="sl-group-title">Panel Layout</div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Left Panel Width</span><span class="sl-val" id="sv-left">250px</span></div><input type="range" class="sl-input" id="sl-left" min="1" max="360" step="5" value="250"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Right Panel Width</span><span class="sl-val" id="sv-right">320px</span></div><input type="range" class="sl-input" id="sl-right" min="1" max="500" step="5" value="320"></div>
      </div>
      <div class="sl-group">
        <div class="sl-group-title">Atmosphere</div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Brightness</span><span class="sl-val" id="sv-bright">100%</span></div><input type="range" class="sl-input" id="sl-bright" min="40" max="160" step="2" value="100"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Panel Opacity</span><span class="sl-val" id="sv-opacity">100%</span></div><input type="range" class="sl-input" id="sl-opacity" min="30" max="100" step="2" value="100"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Scanlines</span><span class="sl-val" id="sv-scan">Low</span></div><input type="range" class="sl-input" id="sl-scan" min="0" max="5" step="1" value="1"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Glow Intensity</span><span class="sl-val" id="sv-glow">100%</span></div><input type="range" class="sl-input" id="sl-glow" min="0" max="200" step="5" value="100"></div>
        <div class="sl-row"><div class="sl-header"><span class="sl-label">Border Sharpness</span><span class="sl-val" id="sv-border">Medium</span></div><input type="range" class="sl-input" id="sl-border" min="0" max="4" step="1" value="2"></div>
      </div>
      <button class="sl-reset" id="sl-reset-all">&#8635; Reset All Display Settings</button>
    </div>
    <div class="opt-section">
      <div class="opt-section-title">Toggle Panels</div>
      <div class="opt-toggles">
        <label class="opt-toggle"><input type="checkbox" id="tog-commander" checked><span class="tog-track"><span class="tog-thumb"></span></span><span class="tog-lbl">Commander</span></label>
        <label class="opt-toggle"><input type="checkbox" id="tog-system" checked><span class="tog-track"><span class="tog-thumb"></span></span><span class="tog-lbl">System Bodies</span></label>
        <label class="opt-toggle"><input type="checkbox" id="tog-scan" checked><span class="tog-track"><span class="tog-thumb"></span></span><span class="tog-lbl">Scan Values</span></label>
        <label class="opt-toggle"><input type="checkbox" id="tog-summary" checked><span class="tog-track"><span class="tog-thumb"></span></span><span class="tog-lbl">Scan Summary</span></label>
        <label class="opt-toggle"><input type="checkbox" id="tog-progress" checked><span class="tog-track"><span class="tog-thumb"></span></span><span class="tog-lbl">Journal Progress</span></label>
        <label class="opt-toggle"><input type="checkbox" id="tog-log" checked><span class="tog-track"><span class="tog-thumb"></span></span><span class="tog-lbl">Application Log</span></label>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>

<!-- ══════════════════════════════════════════════════════════════════════════
     UPDATE AVAILABLE MODAL + PREFERENCES MODAL
     ══════════════════════════════════════════════════════════════════════════ -->
<script src="update-modal.js"></script>
<script src="prefs-modal.js"></script>
</body>
</html>