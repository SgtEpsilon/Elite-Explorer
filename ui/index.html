<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Elite Explorer</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Share+Tech+Mono&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  /* ─── DESIGN TOKENS ─────────────────────────────────────────────── */
  :root {
    --bg:        #080c10;
    --panel:     #0d1117;
    --panel2:    #111820;
    --border:    #1e2d3d;
    --border2:   #243444;
    --gold:      #c8972a;
    --gold-dim:  #8a6518;
    --gold-glow: rgba(200,151,42,0.15);
    --cyan:      #3ecfcf;
    --cyan-dim:  rgba(62,207,207,0.12);
    --red:       #e05252;
    --green:     #4caf7d;
    --text:      #cdd9e5;
    --text-dim:  #6b8099;
    --text-mute: #3d526a;
    --mono:      'Share Tech Mono', monospace;
    --display:   'Orbitron', sans-serif;
    --body:      'Inter', sans-serif;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    width: 100%; height: 100vh;
    background: var(--bg);
    color: var(--text);
    font-family: var(--body);
    font-size: 12px;
    overflow: hidden;
  }

  /* ─── SCANLINE OVERLAY ──────────────────────────────────────────── */
  body::after {
    content: '';
    position: fixed; inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,0.05) 2px,
      rgba(0,0,0,0.05) 4px
    );
    pointer-events: none;
    z-index: 9999;
  }

  /* ─── APP SHELL ─────────────────────────────────────────────────── */
  #app {
    display: grid;
    grid-template-columns: 220px 1fr 320px;
    grid-template-rows: 36px 1fr 120px;
    height: 100vh;
    gap: 1px;
    background: var(--border);
  }

  /* ─── TOPBAR ────────────────────────────────────────────────────── */
  #topbar {
    grid-column: 1 / -1;
    background: var(--panel);
    display: flex;
    align-items: center;
    padding: 0 14px;
    gap: 16px;
    border-bottom: 1px solid var(--border2);
  }

  #topbar .logo {
    font-family: var(--display);
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.2em;
    color: var(--gold);
    text-shadow: 0 0 12px var(--gold-dim);
    white-space: nowrap;
  }

  #topbar .divider {
    width: 1px; height: 18px;
    background: var(--border2);
  }

  #topbar .system-name {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--cyan);
    letter-spacing: 0.05em;
  }

  #topbar .spacer { flex: 1; }

  #topbar .status-chip {
    display: flex; align-items: center; gap: 5px;
    font-family: var(--mono); font-size: 10px;
    color: var(--text-dim);
    padding: 3px 8px;
    border: 1px solid var(--border2);
    border-radius: 2px;
  }

  #topbar .status-chip .dot {
    width: 5px; height: 5px; border-radius: 50%;
    background: var(--green);
    box-shadow: 0 0 6px var(--green);
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  #scan-btn {
    font-family: var(--mono);
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--gold);
    background: transparent;
    border: 1px solid var(--gold-dim);
    padding: 4px 12px;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
  }

  #scan-btn:hover {
    background: var(--gold-glow);
    border-color: var(--gold);
    box-shadow: 0 0 12px var(--gold-glow);
  }

  #scan-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  /* ─── PANELS ────────────────────────────────────────────────────── */
  .panel {
    background: var(--panel);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .panel-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }

  .panel-header .label {
    font-family: var(--display);
    font-size: 8px;
    font-weight: 500;
    letter-spacing: 0.25em;
    color: var(--gold);
    text-transform: uppercase;
  }

  .panel-header .accent-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(to right, var(--border2), transparent);
  }

  .panel-body {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
  }

  .panel-body::-webkit-scrollbar { width: 3px; }
  .panel-body::-webkit-scrollbar-track { background: transparent; }
  .panel-body::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

  /* ─── LEFT PANEL — COMMANDER ────────────────────────────────────── */
  #panel-commander {
    grid-column: 1;
    grid-row: 2 / 4;
  }

  .stat-group {
    margin-bottom: 14px;
  }

  .stat-group-title {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--text-mute);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 6px;
    padding-bottom: 4px;
    border-bottom: 1px solid var(--border);
  }

  .stat-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: 3px 0;
  }

  .stat-key {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--text-dim);
    letter-spacing: 0.05em;
  }

  .stat-val {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--text);
    text-align: right;
  }

  .stat-val.highlight { color: var(--cyan); }
  .stat-val.gold { color: var(--gold); }
  .stat-val.green { color: var(--green); }

  /* Fuel bar */
  .fuel-bar-wrap {
    margin-top: 4px;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .fuel-bar-fill {
    height: 100%;
    background: linear-gradient(to right, var(--cyan-dim), var(--cyan));
    border-radius: 2px;
    transition: width 0.5s ease;
  }

  /* Body type badge */
  .type-badge {
    display: inline-block;
    font-family: var(--mono);
    font-size: 8px;
    padding: 1px 5px;
    border-radius: 1px;
    letter-spacing: 0.05em;
  }

  .type-badge.station  { background: rgba(62,207,207,0.1); color: var(--cyan); border: 1px solid rgba(62,207,207,0.3); }
  .type-badge.fleet    { background: rgba(200,151,42,0.1); color: var(--gold); border: 1px solid rgba(200,151,42,0.3); }

  /* ─── MIDDLE PANEL — SYSTEM BODIES ──────────────────────────────── */
  #panel-system {
    grid-column: 2;
    grid-row: 2;
  }

  /* Bodies grid table */
  .bodies-table {
    width: 100%;
    border-collapse: collapse;
  }

  .bodies-table th {
    font-family: var(--mono);
    font-size: 8px;
    color: var(--text-mute);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    text-align: left;
    padding: 4px 8px;
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
    position: sticky;
    top: 0;
    background: var(--panel);
    z-index: 10;
  }

  .bodies-table td {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--text);
    padding: 5px 8px;
    border-bottom: 1px solid rgba(30,45,61,0.5);
    vertical-align: top;
    line-height: 1.4;
  }

  .bodies-table tr.body-main:hover td { background: rgba(62,207,207,0.04); }
  .bodies-table tr.body-moon td { background: rgba(0,0,0,0.15); }
  .bodies-table tr.body-moon:hover td { background: rgba(62,207,207,0.03); }

  .body-name-cell {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .body-indent { padding-left: 18px !important; }

  .moon-indicator {
    display: inline-block;
    width: 1px;
    height: 12px;
    background: var(--border2);
    margin-right: 4px;
    margin-left: 8px;
    vertical-align: middle;
  }

  .body-icon {
    width: 20px; height: 20px;
    border-radius: 50%;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8px;
    font-family: var(--mono);
  }

  .body-icon.star    { background: radial-gradient(circle at 35% 35%, #fff4cc, #f5a623 60%, #8a4a00); box-shadow: 0 0 8px rgba(245,166,35,0.5); }
  .body-icon.hmc     { background: radial-gradient(circle at 35% 35%, #5e8fbf, #2a5a8a 60%, #0d1e33); box-shadow: 0 0 6px rgba(42,90,138,0.4); }
  .body-icon.rocky   { background: radial-gradient(circle at 35% 35%, #8a7a6a, #5a4a3a 60%, #2a1a0a); }
  .body-icon.gas     { background: radial-gradient(circle at 35% 35%, #c8a87a, #9a7040 60%, #4a3010); box-shadow: 0 0 6px rgba(154,112,64,0.3); }
  .body-icon.icy     { background: radial-gradient(circle at 35% 35%, #d0e8f5, #7ab0d0 60%, #2a5070); }
  .body-icon.moon    { background: radial-gradient(circle at 35% 35%, #7a7a7a, #4a4a4a 60%, #1a1a1a); width:14px; height:14px; }
  .body-icon.station { background: rgba(62,207,207,0.1); border: 1px solid rgba(62,207,207,0.3); border-radius: 2px; color: var(--cyan); font-size: 7px; width:16px; height:16px; }

  .body-class {
    font-size: 9px;
    color: var(--text-dim);
  }

  .val-cell {
    text-align: right;
    color: var(--gold);
  }

  .val-cell.muted { color: var(--text-dim); }

  .info-text {
    font-size: 9px;
    color: var(--text-dim);
    line-height: 1.5;
    max-width: 280px;
  }

  .info-tag {
    display: inline-block;
    font-size: 8px;
    padding: 1px 4px;
    margin: 1px 1px 0 0;
    border-radius: 1px;
    background: rgba(200,151,42,0.08);
    color: var(--gold-dim);
    border: 1px solid rgba(200,151,42,0.2);
  }

  .info-tag.poi {
    background: rgba(62,207,207,0.08);
    color: rgba(62,207,207,0.6);
    border-color: rgba(62,207,207,0.2);
  }

  /* ─── RIGHT TOP PANEL — SCAN VALUES ─────────────────────────────── */
  #panel-scan {
    grid-column: 3;
    grid-row: 2;
  }

  .scan-total-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 10px;
    background: var(--panel2);
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }

  .scan-total-label {
    font-family: var(--mono);
    font-size: 8px;
    color: var(--text-mute);
    letter-spacing: 0.1em;
  }

  .scan-total-val {
    font-family: var(--mono);
    font-size: 13px;
    color: var(--gold);
    text-shadow: 0 0 8px var(--gold-glow);
  }

  .scan-table {
    width: 100%;
    border-collapse: collapse;
  }

  .scan-table th {
    font-family: var(--mono);
    font-size: 8px;
    color: var(--text-mute);
    letter-spacing: 0.1em;
    padding: 3px 6px;
    text-align: left;
    border-bottom: 1px solid var(--border);
    position: sticky; top: 0;
    background: var(--panel);
  }

  .scan-table td {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--text);
    padding: 4px 6px;
    border-bottom: 1px solid rgba(30,45,61,0.4);
    vertical-align: middle;
  }

  .scan-table tr:hover td { background: rgba(62,207,207,0.03); }

  .mapped-icon {
    display: inline-block;
    width: 8px; height: 8px;
    border-radius: 50%;
    vertical-align: middle;
  }

  .mapped-icon.yes  { background: var(--green); box-shadow: 0 0 4px var(--green); }
  .mapped-icon.no   { background: var(--border2); }

  .scan-val { color: var(--gold); text-align: right; }

  /* ─── BOTTOM MIDDLE — PROGRESS ───────────────────────────────────── */
  #panel-progress {
    grid-column: 2;
    grid-row: 3;
    background: var(--panel);
    border-top: 1px solid var(--border);
    display: flex;
    flex-direction: column;
  }

  .progress-track {
    height: 2px;
    background: var(--border);
    flex-shrink: 0;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(to right, var(--cyan-dim), var(--cyan));
    width: 0%;
    transition: width 0.3s ease;
  }

  .progress-info {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--text-dim);
    padding: 4px 10px 0;
    flex-shrink: 0;
  }

  /* ─── BOTTOM RIGHT — LOGS ───────────────────────────────────────── */
  #panel-log {
    grid-column: 3;
    grid-row: 3;
  }

  #log-entries {
    font-family: var(--mono);
    font-size: 9px;
    line-height: 1.6;
    color: var(--text-dim);
    padding: 6px 10px;
    overflow-y: auto;
    flex: 1;
  }

  #log-entries::-webkit-scrollbar { width: 2px; }
  #log-entries::-webkit-scrollbar-thumb { background: var(--border2); }

  .log-entry {
    display: flex;
    gap: 8px;
    padding: 1px 0;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(2px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .log-ts  { color: var(--text-mute); white-space: nowrap; }
  .log-msg { color: var(--text-dim); }
  .log-msg.info  { color: var(--text-dim); }
  .log-msg.good  { color: var(--green); }
  .log-msg.warn  { color: var(--gold); }
  .log-msg.error { color: var(--red); }

  /* ─── BOTTOM LEFT — SCAN SUMMARY ────────────────────────────────── */
  #panel-summary {
    grid-column: 1;
    grid-row: 3;
    background: var(--panel);
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .summary-title {
    font-family: var(--mono);
    font-size: 8px;
    color: var(--text-mute);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    border-bottom: 1px solid var(--border);
    padding-bottom: 4px;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4px 8px;
  }

  .summary-item { }
  .summary-num {
    font-family: var(--mono);
    font-size: 14px;
    color: var(--cyan);
    line-height: 1;
  }
  .summary-lbl {
    font-family: var(--mono);
    font-size: 8px;
    color: var(--text-mute);
    letter-spacing: 0.05em;
  }

  /* ─── EMPTY STATE ────────────────────────────────────────────────── */
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    gap: 8px;
    color: var(--text-mute);
  }

  .empty-state .icon {
    font-size: 28px;
    opacity: 0.3;
  }

  .empty-state .msg {
    font-family: var(--mono);
    font-size: 9px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  /* ─── DRAG REGION ───────────────────────────────────────────────── */
  #topbar {
    -webkit-app-region: drag;
  }

  /* All interactive elements in topbar must opt out of drag */
  #topbar button,
  #topbar .status-chip,
  #topbar #top-system {
    -webkit-app-region: no-drag;
  }

  /* ─── WINDOW CONTROLS ────────────────────────────────────────────── */
  #win-controls {
    display: flex;
    align-items: center;
    gap: 2px;
    margin-left: 4px;
    -webkit-app-region: no-drag;
    flex-shrink: 0;
  }

  .win-btn {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    cursor: pointer;
    border-radius: 2px;
    color: var(--text-mute);
    font-size: 11px;
    transition: background 0.15s, color 0.15s;
    padding: 0;
  }

  .win-btn:hover {
    color: var(--text);
    background: rgba(255,255,255,0.06);
  }

  .win-btn.close:hover {
    background: var(--red);
    color: #fff;
  }

  .win-btn svg {
    width: 10px;
    height: 10px;
    stroke: currentColor;
    fill: none;
    stroke-width: 1.5;
    stroke-linecap: round;
  }

  /* ─── CORNER DECORATIONS ─────────────────────────────────────────── */
  .corner-deco {
    position: relative;
  }
  .corner-deco::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 8px; height: 8px;
    border-top: 1px solid var(--gold-dim);
    border-left: 1px solid var(--gold-dim);
  }
  /* ─── CMDR TAB BUTTON ───────────────────────────────────────────── */
  #cmdr-btn {
    font-family: var(--mono);
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--cyan);
    background: transparent;
    border: 1px solid rgba(62,207,207,0.35);
    padding: 4px 11px;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
  }
  #cmdr-btn:hover {
    background: var(--cyan-dim);
    border-color: var(--cyan);
    box-shadow: 0 0 10px var(--cyan-dim);
  }

  /* ─── CMDR PANEL ─────────────────────────────────────────────────── */
  #cmdr-overlay {
    display: none;
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.65);
    z-index: 2000;
    backdrop-filter: blur(3px);
  }
  #cmdr-overlay.open { display: block; }

  #cmdr-panel {
    position: fixed;
    top: 37px; left: 0; right: 0; bottom: 0;
    background: var(--bg);
    z-index: 2001;
    display: flex; flex-direction: column;
    transform: translateY(-102%);
    transition: transform 0.28s cubic-bezier(0.4,0,0.2,1);
    overflow: hidden;
  }
  #cmdr-panel.open { transform: translateY(0); }

  #cmdr-panel-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 10px 20px;
    border-bottom: 1px solid var(--border2);
    background: var(--panel);
    flex-shrink: 0;
  }
  #cmdr-close {
    font-family: var(--mono); font-size: 11px;
    color: var(--text-dim); background: transparent; border: none;
    cursor: pointer; padding: 2px 6px; transition: color 0.15s;
  }
  #cmdr-close:hover { color: var(--text); }

  #cmdr-body {
    flex: 1; overflow-y: auto; padding: 20px;
    display: flex; flex-direction: column; gap: 14px;
  }
  #cmdr-body::-webkit-scrollbar { width: 3px; }
  #cmdr-body::-webkit-scrollbar-thumb { background: var(--border2); }

  .cmdr-no-data {
    font-family: var(--mono); font-size: 9px;
    color: var(--text-mute); text-align: center;
    padding: 60px 20px; letter-spacing: 0.1em;
  }

  /* Identity card */
  .cmdr-identity {
    display: flex; align-items: center; gap: 20px;
    padding: 16px 20px;
    background: var(--panel);
    border: 1px solid var(--border);
    border-left: 3px solid var(--cyan);
  }
  .cmdr-avatar { font-size: 28px; color: var(--gold); text-shadow: 0 0 20px var(--gold-glow); flex-shrink: 0; width: 52px; text-align: center; }
  .cmdr-big-name { font-family: var(--display); font-size: 14px; color: var(--text); letter-spacing: 0.1em; margin-bottom: 4px; }
  .cmdr-ship-line { font-family: var(--mono); font-size: 9px; margin-bottom: 6px; }
  .cmdr-kv-row { display: flex; gap: 20px; }
  .cmdr-kv-val { font-family: var(--mono); font-size: 12px; color: var(--gold); line-height: 1.1; }
  .cmdr-kv-lbl { font-family: var(--mono); font-size: 7px; color: var(--text-mute); letter-spacing: 0.1em; text-transform: uppercase; }

  /* Two-col layout */
  .cmdr-two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }

  /* Section boxes */
  .cmdr-box { background: var(--panel); border: 1px solid var(--border); padding: 14px 16px; }
  .cmdr-box-title { font-family: var(--display); font-size: 7px; letter-spacing: 0.25em; color: var(--gold); text-transform: uppercase; margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid var(--border); }

  /* Rank rows */
  .cmdr-rank-row { display: grid; grid-template-columns: 82px 1fr 32px; align-items: center; gap: 8px; margin-bottom: 9px; }
  .cmdr-rank-row:last-child { margin-bottom: 0; }
  .cmdr-rank-key { font-family: var(--mono); font-size: 8px; color: var(--text-mute); letter-spacing: 0.08em; text-transform: uppercase; }
  .cmdr-rank-name { font-family: var(--mono); font-size: 8px; margin-bottom: 2px; }
  .cmdr-bar-wrap { height: 3px; background: var(--border); border-radius: 2px; overflow: hidden; }
  .cmdr-bar-fill { height: 100%; border-radius: 2px; transition: width 0.7s ease; }
  .cmdr-rank-pct { font-family: var(--mono); font-size: 7px; color: var(--text-mute); text-align: right; white-space: nowrap; }

  /* Stats grid */
  .cmdr-stats-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
  .cmdr-stat-card { background: var(--panel2); border: 1px solid var(--border); padding: 10px 12px; border-left: 2px solid var(--border2); }
  .cmdr-stat-card.ac-cyan  { border-left-color: var(--cyan); }
  .cmdr-stat-card.ac-gold  { border-left-color: var(--gold); }
  .cmdr-stat-card.ac-green { border-left-color: var(--green); }
  .cmdr-stat-card.ac-red   { border-left-color: var(--red); }
  .cmdr-stat-val { font-family: var(--mono); font-size: 12px; color: var(--text); line-height: 1.1; margin-bottom: 2px; }
  .cmdr-stat-val.vc-cyan  { color: var(--cyan); }
  .cmdr-stat-val.vc-gold  { color: var(--gold); }
  .cmdr-stat-val.vc-green { color: var(--green); }
  .cmdr-stat-lbl { font-family: var(--mono); font-size: 7px; color: var(--text-mute); letter-spacing: 0.08em; text-transform: uppercase; }
</style>
</head>
<body>
<div id="app">

  <!-- ─── TOPBAR ─────────────────────────────────────────────────── -->
  <div id="topbar">
    <span class="logo">ELITE EXPLORER</span>
    <div class="divider"></div>
    <span class="system-name" id="top-system">—</span>
    <div class="spacer"></div>
    <div class="status-chip">
      <span class="dot" id="status-dot"></span>
      <span id="status-text">IDLE</span>
    </div>
    <button id="cmdr-btn">◈ CMDR</button>
    <button id="scan-btn">⬡ Scan All Journals</button>

    <!-- Window controls -->
    <div id="win-controls">
      <button class="win-btn minimize" id="win-min" title="Minimise">
        <svg viewBox="0 0 10 10"><line x1="1" y1="5" x2="9" y2="5"/></svg>
      </button>
      <button class="win-btn maximize" id="win-max" title="Maximise">
        <svg viewBox="0 0 10 10" id="win-max-icon"><rect x="1.5" y="1.5" width="7" height="7" rx="0.5"/></svg>
      </button>
      <button class="win-btn close" id="win-close" title="Close">
        <svg viewBox="0 0 10 10"><line x1="1.5" y1="1.5" x2="8.5" y2="8.5"/><line x1="8.5" y1="1.5" x2="1.5" y2="8.5"/></svg>
      </button>
    </div>
  </div>

  <!-- ─── CMDR PANEL ────────────────────────────────────────────── -->
  <div id="cmdr-overlay"></div>
  <div id="cmdr-panel">
    <div id="cmdr-panel-header">
      <div style="display:flex;align-items:center;gap:14px;">
        <span style="font-family:var(--display);font-size:9px;letter-spacing:0.25em;color:var(--gold)">COMMANDER PROFILE</span>
        <span id="cmdr-header-name" style="font-family:var(--mono);font-size:11px;color:var(--cyan)">— run Scan All Journals to populate —</span>
      </div>
      <button id="cmdr-close">✕</button>
    </div>
    <div id="cmdr-body">

      <div id="cmdr-no-data" class="cmdr-no-data">No commander data yet — run <strong>Scan All Journals</strong> first.</div>

      <div id="cmdr-content" style="display:none;flex-direction:column;gap:14px;">

        <!-- Identity -->
        <div class="cmdr-identity">
          <div class="cmdr-avatar">◈</div>
          <div>
            <div class="cmdr-big-name" id="cmdr-big-name">CMDR —</div>
            <div class="cmdr-ship-line">
              <span id="cmdr-ship-type" style="color:var(--text-dim)">—</span>
              <span style="color:var(--text-mute)"> · </span>
              <span id="cmdr-ship-name" style="color:var(--cyan)">—</span>
              <span style="color:var(--text-mute)"> · </span>
              <span id="cmdr-ship-ident" style="color:var(--text-mute)">—</span>
            </div>
            <div class="cmdr-kv-row">
              <div class="cmdr-kv"><div class="cmdr-kv-val" id="cmdr-credits">—</div><div class="cmdr-kv-lbl">Credits</div></div>
              <div class="cmdr-kv"><div class="cmdr-kv-val" style="color:var(--text-dim)" id="cmdr-mode">—</div><div class="cmdr-kv-lbl">Game Mode</div></div>
            </div>
          </div>
        </div>

        <!-- Ranks + Reputation -->
        <div class="cmdr-two-col">
          <div class="cmdr-box">
            <div class="cmdr-box-title">Ranks</div>
            <div id="cmdr-ranks"></div>
          </div>
          <div class="cmdr-box">
            <div class="cmdr-box-title">Superpower Reputation</div>
            <div id="cmdr-rep"></div>
          </div>
        </div>

        <!-- Lifetime stats -->
        <div class="cmdr-box">
          <div class="cmdr-box-title">Lifetime Statistics</div>
          <div class="cmdr-stats-grid" id="cmdr-stats"></div>
        </div>

      </div>
    </div>
  </div>

  <!-- ─── LEFT: COMMANDER INFO ──────────────────────────────────── -->
  <div class="panel" id="panel-commander">
    <div class="panel-header">
      <span class="label">Commander</span>
      <div class="accent-line"></div>
    </div>
    <div class="panel-body">

      <div class="stat-group">
        <div class="stat-group-title">Navigation</div>
        <div class="stat-row">
          <span class="stat-key">System</span>
          <span class="stat-val highlight" id="sys-name">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Pos</span>
          <span class="stat-val" id="sys-pos" style="font-size:9px">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Dest</span>
          <span class="stat-val" id="sys-dest" style="font-size:9px;color:var(--text-dim)">—</span>
        </div>
      </div>

      <div class="stat-group">
        <div class="stat-group-title">Ship Status</div>
        <div class="stat-row">
          <span class="stat-key">Ship</span>
          <span class="stat-val" id="ship-name" style="font-size:9px">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Range</span>
          <span class="stat-val" id="ship-range">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Fuel</span>
          <span class="stat-val" id="ship-fuel">—</span>
        </div>
        <div class="fuel-bar-wrap">
          <div class="fuel-bar-fill" id="fuel-bar" style="width: 60%"></div>
        </div>
      </div>

      <div class="stat-group">
        <div class="stat-group-title">Station</div>
        <div class="stat-row">
          <span class="stat-key">Name</span>
          <span class="stat-val" id="station-name" style="font-size:9px;color:var(--text-dim)">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Faction</span>
          <span class="stat-val" id="station-faction" style="font-size:9px;color:var(--text-dim)">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Visits</span>
          <span class="stat-val" id="station-visits">—</span>
        </div>
        <div class="stat-row">
          <span class="stat-key">Credits</span>
          <span class="stat-val gold" id="credits">—</span>
        </div>
      </div>

      <div class="stat-group">
        <div class="stat-group-title">Services</div>
        <div class="stat-row">
          <span class="stat-key">Open</span>
          <span class="stat-val">
            <span class="type-badge station" id="open-services">—</span>
          </span>
        </div>
      </div>

    </div>
  </div>

  <!-- ─── MIDDLE: SYSTEM BODIES ─────────────────────────────────── -->
  <div class="panel" id="panel-system">
    <div class="panel-header">
      <span class="label">System Bodies</span>
      <div class="accent-line"></div>
      <span style="font-family:var(--mono);font-size:9px;color:var(--text-mute)" id="body-count">0 bodies</span>
    </div>
    <div class="panel-body" style="padding:0;">
      <table class="bodies-table" id="bodies-table">
        <thead>
          <tr>
            <th style="width:28px"></th>
            <th>Name</th>
            <th>Class</th>
            <th>Distance</th>
            <th>Information</th>
            <th style="text-align:right">Value</th>
            <th style="text-align:right">Max</th>
          </tr>
        </thead>
        <tbody id="bodies-tbody">
          <tr><td colspan="7">
            <div class="empty-state">
              <div class="icon">◎</div>
              <div class="msg">Awaiting scan data</div>
            </div>
          </td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ─── RIGHT: SCAN VALUES ────────────────────────────────────── -->
  <div class="panel" id="panel-scan">
    <div class="panel-header">
      <span class="label">Scan Values</span>
      <div class="accent-line"></div>
    </div>
    <div class="scan-total-bar">
      <span class="scan-total-label">EST. TOTAL</span>
      <span class="scan-total-val" id="scan-total">0 cr</span>
    </div>
    <div class="panel-body" style="padding:0;">
      <table class="scan-table" id="scan-table">
        <thead>
          <tr>
            <th>Body</th>
            <th>Type</th>
            <th style="text-align:center">Mapped</th>
            <th style="text-align:right">Value</th>
          </tr>
        </thead>
        <tbody id="scan-tbody">
          <tr><td colspan="4">
            <div class="empty-state" style="height:60px;">
              <div class="msg">No scans yet</div>
            </div>
          </td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ─── BOTTOM LEFT: SUMMARY ──────────────────────────────────── -->
  <div id="panel-summary">
    <div class="summary-title">Scan Summary</div>
    <div class="summary-grid">
      <div class="summary-item">
        <div class="summary-num" id="sum-stars">0</div>
        <div class="summary-lbl">Stars</div>
      </div>
      <div class="summary-item">
        <div class="summary-num" id="sum-planets">0</div>
        <div class="summary-lbl">Planets</div>
      </div>
      <div class="summary-item">
        <div class="summary-num" id="sum-moons">0</div>
        <div class="summary-lbl">Moons</div>
      </div>
      <div class="summary-item">
        <div class="summary-num" id="sum-total">0</div>
        <div class="summary-lbl">Total</div>
      </div>
    </div>
  </div>

  <!-- ─── BOTTOM MIDDLE: PROGRESS ───────────────────────────────── -->
  <div id="panel-progress">
    <div class="panel-header" style="padding:6px 10px;">
      <span class="label">Journal Scan</span>
      <div class="accent-line"></div>
      <span style="font-family:var(--mono);font-size:9px;color:var(--text-mute)" id="progress-pct">—</span>
    </div>
    <div class="progress-track">
      <div class="progress-fill" id="progress-bar"></div>
    </div>
    <div class="progress-info" id="progress-info">Ready</div>
    <div class="panel-body" style="padding:6px 10px; overflow:hidden;">
      <div style="font-family:var(--mono);font-size:9px;color:var(--text-mute)" id="progress-detail"></div>
    </div>
  </div>

  <!-- ─── BOTTOM RIGHT: LOGS ────────────────────────────────────── -->
  <div class="panel" id="panel-log">
    <div class="panel-header">
      <span class="label">Application Log</span>
      <div class="accent-line"></div>
      <span id="log-count" style="font-family:var(--mono);font-size:9px;color:var(--text-mute)">0 entries</span>
    </div>
    <div id="log-entries"></div>
  </div>

</div>

<script>
// ─── UTILITIES ────────────────────────────────────────────────────
function fmt(n) {
  if (n == null || n === 0) return '—';
  return Number(n).toLocaleString() + ' cr';
}
function fmtNum(n) {
  return n == null ? '—' : Number(n).toLocaleString();
}
function ts() {
  const d = new Date();
  return d.toTimeString().slice(0,8);
}

// ─── LOGGING ──────────────────────────────────────────────────────
let logCount = 0;
function log(msg, type = 'info') {
  logCount++;
  document.getElementById('log-count').textContent = logCount + ' entries';
  const el = document.getElementById('log-entries');
  const entry = document.createElement('div');
  entry.className = 'log-entry';
  entry.innerHTML = `<span class="log-ts">${ts()}</span><span class="log-msg ${type}">${msg}</span>`;
  el.appendChild(entry);
  el.scrollTop = el.scrollHeight;
}

// ─── MOCK DATA for demo (replace with real IPC/API data) ──────────
const MOCK_BODIES = [
  {
    id: 'HIP 39418', cls: 'White F class star', clsShort: 'F9V', iconType: 'star',
    dist: 'Main Star', isMoon: false,
    info: ['Mass: 1.43 SM', 'Radius: 1.26 SR', 'Temp: 7,268 K', 'HZ: 1.56–3.12 AU'],
    tags: [],
    value: 1225, maxVal: 1225
  },
  {
    id: 'HIP 39418 1', cls: 'High metal content world', clsShort: 'HMC', iconType: 'hmc',
    dist: '0.34 AU', isMoon: false,
    info: ['Radius: 11,260 km', 'Temp: 551.55 K', 'Landable (G: 3.0)'],
    tags: ['Silicate Geysers', 'Volcanism', 'Serendibite'],
    value: 18174, maxVal: 98446
  },
  {
    id: 'HIP 39418 1a', cls: 'Rocky body Moon', clsShort: 'RKM', iconType: 'moon',
    dist: '133,937 km', isMoon: true,
    info: ['Radius: 418 km', 'Landable'],
    tags: ['Carbon', 'Niobium'],
    value: 500, maxVal: 2777
  },
  {
    id: 'HIP 39418 1b', cls: 'Rocky body Moon', clsShort: 'RKM', iconType: 'moon',
    dist: '162,869 km', isMoon: true,
    info: ['Radius: 415 km', 'Landable'],
    tags: ['Carbon', 'Germanium'],
    value: 500, maxVal: 2777
  },
  {
    id: 'HIP 39418 2', cls: 'High metal content world', clsShort: 'HMC', iconType: 'hmc',
    dist: '0.62 AU', isMoon: false,
    info: ['Radius: 9,953 km', 'Temp: 466 K', 'Thick Sulphur Dioxide Atmosphere'],
    tags: ['Silicate Geysers', 'Volcanism'],
    value: 17400, maxVal: 94254
  },
  {
    id: 'HIP 39418 9', cls: 'Class I gas giant', clsShort: 'GAS', iconType: 'gas',
    dist: '3.17 AU', isMoon: false,
    info: ['Landable: No', 'Ring system present'],
    tags: [],
    value: 3336, maxVal: 14456
  },
];

const MOCK_SCANS = [
  { body: 'HIP 39418 6',  type: 'High metal content', mapped: true,  value: 185702 },
  { body: 'HIP 39418 1',  type: 'High metal content', mapped: false, value: 18174  },
  { body: 'HIP 39418 2',  type: 'High metal content', mapped: false, value: 17400  },
  { body: 'HIP 39418 3',  type: 'High metal content', mapped: false, value: 15775  },
  { body: 'HIP 39418 9',  type: 'Class I gas giant',  mapped: false, value: 3336   },
  { body: 'HIP 39418',    type: 'White F class star',  mapped: false, value: 1225   },
];

// ─── POPULATE COMMANDER PANEL ──────────────────────────────────────
function populateCommander() {
  document.getElementById('sys-name').textContent    = 'HIP 39418';
  document.getElementById('top-system').textContent  = 'HIP 39418';
  document.getElementById('sys-pos').textContent     = '67.19, 53.72, -115';
  document.getElementById('sys-dest').textContent    = '—';
  document.getElementById('ship-name').textContent   = 'EP-11L Type-11 Prospector';
  document.getElementById('ship-range').textContent  = '16.38 ly';
  document.getElementById('ship-fuel').textContent   = '30.2 / 32';
  document.getElementById('fuel-bar').style.width    = '94%';
  document.getElementById('station-name').textContent   = 'Wallace Terminal';
  document.getElementById('station-faction').textContent = 'Flat Galaxy Society';
  document.getElementById('station-visits').textContent = '2';
  document.getElementById('credits').textContent     = '76,138,280 cr';
  document.getElementById('open-services').textContent  = 'EDSM · INARA';
}

// ─── POPULATE BODIES TABLE ─────────────────────────────────────────
function populateBodies() {
  const tbody = document.getElementById('bodies-tbody');
  tbody.innerHTML = '';

  let stars = 0, planets = 0, moons = 0;

  MOCK_BODIES.forEach(b => {
    const tr = document.createElement('tr');
    tr.className = b.isMoon ? 'body-moon' : 'body-main';

    const iconHtml = `<div class="body-icon ${b.iconType}"></div>`;
    const tagsHtml = b.tags.map(t => `<span class="info-tag poi">${t}</span>`).join('');
    const infoHtml = b.info.map(i => `<div>${i}</div>`).join('');
    const moonPrefix = b.isMoon ? '<span class="moon-indicator"></span>' : '';

    tr.innerHTML = `
      <td style="text-align:center;padding:4px 4px;">
        ${b.isMoon ? '<div style="display:flex;justify-content:center;">' + iconHtml + '</div>' : iconHtml}
      </td>
      <td class="${b.isMoon ? 'body-indent' : ''}">
        <div class="body-name-cell">
          ${moonPrefix}
          <span style="font-size:${b.isMoon ? '9' : '10'}px;color:${b.isMoon ? 'var(--text-dim)' : 'var(--text)'}">${b.id}</span>
        </div>
      </td>
      <td class="body-class">${b.cls}</td>
      <td style="font-size:9px;color:var(--text-dim);white-space:nowrap">${b.dist}</td>
      <td>
        <div class="info-text">${infoHtml}</div>
        <div style="margin-top:3px">${tagsHtml}</div>
      </td>
      <td class="val-cell">${fmt(b.value)}</td>
      <td class="val-cell muted" style="font-size:9px">${fmt(b.maxVal)}</td>
    `;
    tbody.appendChild(tr);

    const t = b.iconType;
    if (t === 'star') stars++;
    else if (b.isMoon) moons++;
    else planets++;
  });

  document.getElementById('body-count').textContent = `${MOCK_BODIES.length} bodies`;
  document.getElementById('sum-stars').textContent   = stars;
  document.getElementById('sum-planets').textContent = planets;
  document.getElementById('sum-moons').textContent   = moons;
  document.getElementById('sum-total').textContent   = MOCK_BODIES.length;
}

// ─── POPULATE SCAN TABLE ───────────────────────────────────────────
function populateScans() {
  const tbody = document.getElementById('scan-tbody');
  tbody.innerHTML = '';
  let total = 0;

  MOCK_SCANS.forEach(s => {
    total += s.value;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="font-size:9px">${s.body}</td>
      <td style="font-size:8px;color:var(--text-dim)">${s.type}</td>
      <td style="text-align:center">
        <span class="mapped-icon ${s.mapped ? 'yes' : 'no'}"></span>
      </td>
      <td class="scan-val">${fmtNum(s.value)}</td>
    `;
    tbody.appendChild(tr);
  });

  document.getElementById('scan-total').textContent = total.toLocaleString() + ' cr';
}

// ─── LIVE SCAN DATA (from journal events via IPC) ──────────────────
window.electronAPI.onScanAll(() => {
  setStatus('SCANNING', true);
  log('Scan All Journals triggered', 'warn');
  document.getElementById('scan-btn').disabled = true;
});

window.electronAPI.onProgress((data) => {
  const filePct = Math.round((data.currentLine / data.totalLines) * 100);
  const overall = Math.round(((data.fileIndex - 1 + data.currentLine / data.totalLines) / data.totalFiles) * 100);

  document.getElementById('progress-bar').style.width  = overall + '%';
  document.getElementById('progress-pct').textContent  = overall + '%';
  document.getElementById('progress-info').textContent = `File ${data.fileIndex} of ${data.totalFiles}`;
  document.getElementById('progress-detail').textContent = `${data.file}  ·  line ${data.currentLine} / ${data.totalLines}  (${filePct}%)`;

  if (overall >= 100) {
    setTimeout(() => {
      document.getElementById('progress-bar').style.width  = '0%';
      document.getElementById('progress-pct').textContent  = '—';
      document.getElementById('progress-info').textContent = 'Ready';
      document.getElementById('progress-detail').textContent = '';
      setStatus('IDLE', false);
      document.getElementById('scan-btn').disabled = false;
      log('Scan complete', 'good');
    }, 800);
  }
});

// Status helper
function setStatus(txt, scanning) {
  document.getElementById('status-text').textContent = txt;
  const dot = document.getElementById('status-dot');
  dot.style.background = scanning ? 'var(--gold)' : 'var(--green)';
  dot.style.boxShadow  = scanning ? '0 0 6px var(--gold)' : '0 0 6px var(--green)';
}

// Scan button
document.getElementById('scan-btn').addEventListener('click', () => {
  window.electronAPI.triggerScanAll();
});

// ─── PERIODIC STATS REFRESH (from API) ────────────────────────────
async function refreshStats() {
  try {
    const res = await fetch('http://localhost:3721/stats');
    const d = await res.json();
    // Update scan count if desired
    log(`DB scans: ${d.scans}`, 'info');
  } catch {}
}

// ─── BOOT ──────────────────────────────────────────────────────────
populateCommander();
populateBodies();
populateScans();

log('Elite Explorer initialised', 'good');
log('Journal watcher active', 'info');
log('API connected on :3721', 'info');

// Refresh stats every 30s
setInterval(refreshStats, 30000);
// ─── WINDOW CONTROLS ───────────────────────────────────────────────
document.getElementById('win-min').addEventListener('click', () => window.electronAPI.winMinimize());
document.getElementById('win-close').addEventListener('click', () => window.electronAPI.winClose());

const winMaxBtn = document.getElementById('win-max');
const winMaxIcon = document.getElementById('win-max-icon');

async function updateMaxIcon() {
  const isMax = await window.electronAPI.winIsMaximized();
  // Restore icon when maximised, maximise icon otherwise
  winMaxIcon.innerHTML = isMax
    ? '<polyline points="3,1.5 8.5,1.5 8.5,7"/><rect x="1.5" y="3" width="6" height="6" rx="0.5"/>'
    : '<rect x="1.5" y="1.5" width="7" height="7" rx="0.5"/>';
  winMaxBtn.title = isMax ? 'Restore' : 'Maximise';
}

winMaxBtn.addEventListener('click', async () => {
  await window.electronAPI.winMaximize();
  updateMaxIcon();
});

updateMaxIcon();

function openCmdr()  { document.getElementById('cmdr-panel').classList.add('open');    document.getElementById('cmdr-overlay').classList.add('open'); }
function closeCmdr() { document.getElementById('cmdr-panel').classList.remove('open'); document.getElementById('cmdr-overlay').classList.remove('open'); }
document.getElementById('cmdr-btn').addEventListener('click', openCmdr);
document.getElementById('cmdr-close').addEventListener('click', closeCmdr);
document.getElementById('cmdr-overlay').addEventListener('click', closeCmdr);

// ─── CMDR DATA (from IPC) ─────────────────────────────────────────
function fmtCr(n)   { return n == null ? '—' : Number(n).toLocaleString() + ' cr'; }
function fmtDist(n) { return n == null ? '—' : Number(n).toFixed(1) + ' ly'; }
function fmtTime(s) { if (!s) return '—'; const h = Math.floor(s/3600), d = Math.floor(h/24); return d > 0 ? d+'d '+(h%24)+'h' : h+'h'; }

function rankColour(level, max) {
  if (level == null) return 'var(--text-mute)';
  if (level >= max)  return 'var(--gold)';
  const t = level / max;
  return t < 0.33 ? 'var(--text-dim)' : t < 0.66 ? 'var(--cyan)' : 'var(--green)';
}

function renderRankRow(label, level, name, pct, max) {
  const col = rankColour(level, max);
  return `<div class="cmdr-rank-row">
    <span class="cmdr-rank-key">${label}</span>
    <div>
      <div class="cmdr-rank-name" style="color:${col}">${name}</div>
      <div class="cmdr-bar-wrap"><div class="cmdr-bar-fill" style="width:${pct||0}%;background:${col};opacity:0.75"></div></div>
    </div>
    <span class="cmdr-rank-pct">${pct != null ? pct+'%' : ''}</span>
  </div>`;
}

function renderRepRow(label, value, col) {
  const pct = Math.round(((value||0) + 100) / 2);
  const sign = (value||0) >= 0 ? '+' : '';
  return `<div class="cmdr-rank-row">
    <span class="cmdr-rank-key">${label}</span>
    <div class="cmdr-bar-wrap" style="margin-top:4px"><div class="cmdr-bar-fill" style="width:${pct}%;background:${col};opacity:0.7"></div></div>
    <span class="cmdr-rank-pct" style="color:${col}">${sign}${(value||0).toFixed(0)}</span>
  </div>`;
}

function renderStatCard(val, lbl, ac, vc) {
  return `<div class="cmdr-stat-card ${ac||''}"><div class="cmdr-stat-val ${vc||''}">${val}</div><div class="cmdr-stat-lbl">${lbl}</div></div>`;
}

window.electronAPI.onCmdrData((d) => {
  const rk = d.ranks    || {};
  const pr = d.progress || {};
  const rep= d.reputation || {};
  const st = d.stats    || {};

  // Fill identity
  document.getElementById('cmdr-header-name').textContent = d.name ? 'CMDR '+d.name : '—';
  document.getElementById('cmdr-big-name').textContent    = d.name ? 'CMDR '+d.name : '—';
  document.getElementById('cmdr-ship-type').textContent   = d.ship      || '—';
  document.getElementById('cmdr-ship-name').textContent   = d.shipName  || '—';
  document.getElementById('cmdr-ship-ident').textContent  = d.shipIdent || '—';
  document.getElementById('cmdr-credits').textContent     = fmtCr(d.credits);
  document.getElementById('cmdr-mode').textContent        = d.gameMode  || '—';

  // Fill ranks
  document.getElementById('cmdr-ranks').innerHTML = [
    rk.combat     ? renderRankRow('Combat',      rk.combat.level,     rk.combat.name,     pr.combat,     8)  : '',
    rk.trade      ? renderRankRow('Trade',       rk.trade.level,      rk.trade.name,      pr.trade,      8)  : '',
    rk.explore    ? renderRankRow('Exploration', rk.explore.level,    rk.explore.name,    pr.explore,    8)  : '',
    rk.cqc        ? renderRankRow('CQC',         rk.cqc.level,        rk.cqc.name,        pr.cqc,        8)  : '',
    rk.empire     ? renderRankRow('Empire',      rk.empire.level,     rk.empire.name,     pr.empire,     14) : '',
    rk.federation ? renderRankRow('Federation',  rk.federation.level, rk.federation.name, pr.federation, 14) : '',
    rk.exobiology?.name ? renderRankRow('Exobiology', rk.exobiology.level, rk.exobiology.name, null, 8) : '',
  ].join('');

  // Fill reputation
  document.getElementById('cmdr-rep').innerHTML = [
    renderRepRow('Empire',      rep.empire,      '#c09060'),
    renderRepRow('Federation',  rep.federation,  '#6090c0'),
    renderRepRow('Alliance',    rep.alliance,    '#60c060'),
    renderRepRow('Independent', rep.independent, 'var(--text-dim)'),
  ].join('');

  // Fill stats
  document.getElementById('cmdr-stats').innerHTML = [
    renderStatCard(st.systemsVisited?.toLocaleString()||'0',  'Systems Visited',      'ac-cyan',  'vc-cyan'),
    renderStatCard(st.jumpsTotal?.toLocaleString()||'0',       'Hyperspace Jumps',     'ac-cyan',  'vc-cyan'),
    renderStatCard(fmtDist(st.distanceTravelled),              'Distance Travelled',   'ac-cyan',  'vc-cyan'),
    renderStatCard(fmtDist(st.greatestDistance),               'Furthest From Origin', 'ac-cyan',  'vc-cyan'),
    renderStatCard(fmtTime(st.timePlayed),                     'Time Played',          '',         ''),
    renderStatCard(st.planetsScanned?.toLocaleString()||'0',   'Planets Scanned L3',   'ac-cyan',  'vc-cyan'),
    renderStatCard(st.efficientScans?.toLocaleString()||'0',   'Efficient Scans',      'ac-cyan',  'vc-cyan'),
    renderStatCard(fmtCr(st.explorationProfit),                'Exploration Profit',   'ac-cyan',  'vc-cyan'),
    renderStatCard(st.organicsSold?.toLocaleString()||'0',     'Organics Sold',        'ac-gold',  'vc-gold'),
    renderStatCard(fmtCr(st.exoProfit),                        'Exobiology Profit',    'ac-gold',  'vc-gold'),
    renderStatCard(st.kills?.toLocaleString()||'0',            'Kills',                'ac-red',   ''),
    renderStatCard(st.bounties?.toLocaleString()||'0',         'Bounties Claimed',     'ac-red',   ''),
    renderStatCard(fmtCr(st.bountyCreds),                      'Bounty Profits',       'ac-red',   ''),
    renderStatCard(fmtCr(st.assassinations),                   'Assassination Profit', 'ac-red',   ''),
    renderStatCard(st.tradeTransactions?.toLocaleString()||'0','Trade Transactions',   'ac-green', 'vc-green'),
    renderStatCard(fmtCr(st.tradingProfit),                    'Trading Profit',       'ac-green', 'vc-green'),
    renderStatCard(fmtCr(st.miningProfit),                     'Mining Profit',        'ac-green', 'vc-green'),
    renderStatCard(fmtCr(st.smugglingProfit),                  'Smuggling Profit',     'ac-green', 'vc-green'),
    renderStatCard(fmtCr(st.searchRescueProfit),               'Search & Rescue',      '',         ''),
    renderStatCard(st.quantityMined?.toLocaleString()||'0',    'Quantity Mined',       '',         ''),
  ].join('');

  // Show content
  document.getElementById('cmdr-no-data').style.display  = 'none';
  document.getElementById('cmdr-content').style.display  = 'flex';
  log('CMDR data loaded: ' + (d.name||'?'), 'good');
});
</script>
</body>
</html>